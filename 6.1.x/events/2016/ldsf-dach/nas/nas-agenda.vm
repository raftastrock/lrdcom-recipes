#*
    This template basically loops once through all the records creating a treemap
    object and then loops through that map object to generate the table. When
    constructing the map it starts at the bottom (that is the deepest branches)
    of the tree and works its way up, since we are adding individual records in the
    correct places in tree. It is basically structured like this:

    agenda={
        day-2013-1-1={
            row-100={
                end-time=000900,
                end-time-display=9:00am,
                extended-sessions= {
                    room-1=001000
                },
                sessions={
                    room-1={
                        end-time=000900,
                        map-id=290837,
                    record={},
            room-name=Grand Ballroom,
            room-number=1
          }
        },
        start-time=000800,
        start-time=8:00am
      }
    }
  }
*#

<div class="categorySelectors category-toggle-container desktop-hidden">
  <div class="aui-toggler-header aui-toggler-header-collapsed toggle-header">
    Filter by <span class="arrow"></span>
  </div>
  <div class="aui-toggler-content aui-toggler-content-collapsed toggle-content">
    <a class="category" data-target-class="marketing" data-selected="false">Digital Marketing & Web Experiences</a>
    <a class="category" data-target-class="using" data-selected="false">Case Study</a>
    <a class="category" data-target-class="customize" data-selected="false">Customizing Liferay</a>
    <a class="category" data-target-class="develop" data-selected="false">Developing with Liferay</a>
    <a class="category" data-target-class="production" data-selected="false">Liferay in Production</a>
    <a class="category" data-target-class="features" data-selected="false">Liferay New Products & Features</a>
    <a class="category" data-target-class="technologies" data-selected="false">Mobile Technologies & Development</a>
    <a class="category" data-target-class="ui" data-selected="false">UI & UX</a>
  </div>
</div>

#macro (mark_as_extended5 $end_time $row_end_time $row_start_time)
  #if ($end_time > $row_end_time)
    #set ($extension_count = $extension_count + 1)
    #set ($next_row = false)
    #set ($next_row = $day.higherEntry("row-$row_start_time"))

    #if ($next_row)
      #set($next_row = $next_row.getValue())
      #set($void = $next_row.get("extended-sessions").put("room-$room_number", $end_time))

      #set($next_row_end_time = $integer.parseInt($next_row.get("end-time")))
      #set($next_row_start_time = $next_row.get("start-time"))

      #mark_as_extended5($end_time $next_row_end_time $next_row_start_time)
    #end
  #end
#end

#set ($days_to_print = "day-2015-11-15,day-2015-11-16,day-2015-11-17")

#set ($default_col_span = 2)
#set ($integer = 0)
#set ($link_to_speakers_page = "/web/events2015/northamerica/speakers")

## Prep work for Edit button
#set ($layout_id = $request.get("theme-display").get("plid"))
#set ($layout_service = $serviceLocator.findService("com.liferay.portal.service.LayoutLocalService"))
#set ($layout_long = $getterUtil.getLong($layout_id))
#set ($layout = $layout_service.getLayout($layout_long))
#set ($user_has_permissions = $layoutPermission.contains($permissionChecker, $layout, "UPDATE"))

## Get DDL Records
#set ($ddl_records_local_service = $serviceLocator.findService("com.liferay.portlet.dynamicdatalists.service.DDLRecordLocalService"))
#set ($record_set_id = $getterUtil.getLong($reserved_record_set_id.data))
#set ($records = $ddl_records_local_service.getRecords($record_set_id))

## Create the empty map that will hold all the agenda info
#set ($agenda = $portal.getClass().forName("java.util.TreeMap").newInstance())

## Loop Through records and place them in the correct place in the map
#foreach ($record in $records)
  #if ($record.getFieldValue("display_on_live"))
    ## Get date, start-time, end-time and room for sorting purposes
    #set ($date = $record.getFieldValue("date"))

    #set ($start_time_hour = $record.getFieldValue("start_time_hour"))
    #set ($start_time_hour = $stringUtil.replace($start_time_hour, "[", ""))
    #set ($start_time_hour = $stringUtil.replace($start_time_hour, "]", ""))
    #set ($start_time_hour = $stringUtil.replace($start_time_hour, '"', ''))
    #set ($start_time_hour_int = $integer.parseInt($start_time_hour))
    #if ($start_time_hour_int >= 12)
      #set ($start_time_am_pm = "pm")
      #if ($start_time_hour_int > 12)
        #set ($start_time_hour_int = $start_time_hour_int - 12)
      #end
    #else
      #set ($start_time_am_pm = "am")
    #end

    #if ($start_time_hour.length() == 1)
      #set ($start_time_hour_sort = "0" + $start_time_hour)
    #else
      #set ($start_time_hour_sort = $start_time_hour)
    #end

    #set ($start_time_minutes = $record.getFieldValue("start_time_minutes"))
    #set ($start_time_minutes = $stringUtil.replace($start_time_minutes, "[", ""))
    #set ($start_time_minutes = $stringUtil.replace($start_time_minutes, "]", ""))
    #set ($start_time_minutes = $stringUtil.replace($start_time_minutes, '"', ''))
    #if ($start_time_minutes == "0" || $start_time_minutes == "5")
      #set ($start_time_minutes = "0" + $start_time_minutes)
    #end

    #set ($start_time_display = $start_time_hour_int + ":" + $start_time_minutes + $start_time_am_pm)
    #set ($start_time_sort = $start_time_hour_sort + $start_time_minutes)

    #set ($end_time_hour = $record.getFieldValue("end_time_hour"))
    #set ($end_time_hour = $stringUtil.replace($end_time_hour, "[", ""))
    #set ($end_time_hour = $stringUtil.replace($end_time_hour, "]", ""))
    #set ($end_time_hour = $stringUtil.replace($end_time_hour, '"', ''))

    #set ($end_time_hour_int = $integer.parseInt($end_time_hour))
    #if ($end_time_hour_int >= 12)
      #set ($end_time_am_pm = "pm")
      #if ($end_time_hour_int > 12)
        #set ($end_time_hour_int = $end_time_hour_int - 12)
      #end
    #else
      #set ($end_time_am_pm = "am")
    #end

    #if ($end_time_hour.length() == 1)
      #set ($end_time_hour_sort = "0" + $end_time_hour)
    #else
      #set ($end_time_hour_sort = $end_time_hour)
    #end

    #set ($end_time_minutes = $record.getFieldValue("end_time_minutes"))
    #set ($end_time_minutes = $stringUtil.replace($end_time_minutes, "[", ""))
    #set ($end_time_minutes = $stringUtil.replace($end_time_minutes, "]", ""))
    #set ($end_time_minutes = $stringUtil.replace($end_time_minutes, '"', ''))
    #if ($end_time_minutes == "0" || $end_time_minutes == "5")
      #set ($end_time_minutes = "0" + $end_time_minutes)
    #end

    #set ($end_time_display = $end_time_hour_int + ":" +$end_time_minutes + $end_time_am_pm)
    #set ($end_time_sort = $end_time_hour_sort + $end_time_minutes)

    #set ($room_uuid = $record.getFieldValue("room_uuid"))
    #set ($room_uuid = $stringUtil.replace($room_uuid, "[", ""))
    #set ($room_uuid = $stringUtil.replace($room_uuid, "]", ""))
    #set ($room_uuid = $stringUtil.replace($room_uuid, '"', ''))

    #set ($room_record_info = $ddl_records_local_service.getDDLRecordByUuidAndGroupId($room_uuid, $groupId))
    #set ($room_record = $ddl_records_local_service.fetchDDLRecord($getterUtil.getLong($room_record_info.recordId)))

    #if ($room_record)
      #set ($room_name = $room_record.getFieldValue("room_name"))
      #set ($room_number = $room_record.getFieldValue("room_number"))
      #set ($map_id = $room_record.getFieldValue("map_id"))
    #else
      #set ($room_name = "")
      #set ($room_number = 0)
      #set ($map_id = "")
    #end

    ## Create parts of map that dont exist
    #if (!$agenda.get("day-$date"))
      #set ($void = $agenda.put("day-$date", $portal.getClass().forName("java.util.TreeMap").newInstance()))
    #end

    #if (!$agenda.get("day-$date").get("row-$start_time_sort"))
      #set ($row_map = $portal.getClass().forName("java.util.TreeMap").newInstance())
      #set ($void = $row_map.put("end-time", $end_time_sort))
      #set ($void = $row_map.put("end-time-display", $end_time_display))
      #set ($void = $row_map.put("extended-sessions", $portal.getClass().forName("java.util.TreeMap").newInstance()))
      #set ($void = $row_map.put("sessions", $portal.getClass().forName("java.util.TreeMap").newInstance()))
      #set ($void = $row_map.put("start-time", $start_time_sort))
      #set ($void = $row_map.put("start-time-display", $start_time_display))
      #set ($void = $agenda.get("day-$date").put("row-$start_time_sort", $row_map))
    #end

    ## Add content to map
    #set ($existing_row_map = $agenda.get("day-$date").get("row-$start_time_sort"))
    #set ($existing_session_map = $existing_row_map.get("sessions"))
    #set ($session_map_info = $portal.getClass().forName("java.util.TreeMap").newInstance())
    #set ($void = $session_map_info.put("custom-css-class", $record.getFieldValue("custom_css_class")))
    #set ($void = $session_map_info.put("filter-categories", $record.getFieldValue("filter_categories")))
    #set ($void = $session_map_info.put("is-liferay-seven", $record.getFieldValue("is_liferay_seven")))
    #set ($void = $session_map_info.put("end-time", $end_time_sort))
    #set ($void = $session_map_info.put("end-time-display", $end_time_display))
    #set ($void = $session_map_info.put("map-id", $map_id))
    #set ($void = $session_map_info.put("room-name", $room_name))
    #set ($void = $session_map_info.put("record", $record))
    #set ($int_room_number = $getterUtil.getInteger($room_number))
    #set ($mod_room_number = 100 + $int_room_number)
    #set ($void = $session_map_info.put("room-number", $mod_room_number))
    #set ($void = $existing_session_map.put("room-$mod_room_number", $session_map_info))
    #set ($void = $existing_row_map.put("sessions", $existing_session_map))

    #set ($existing_end_time = $existing_row_map.get("end-time"))

    #if ($integer.parseInt($end_time_sort) < $integer.parseInt($existing_end_time))
      #set ($void = $existing_row_map.put("end-time", $end_time_sort))
      #set ($void = $existing_row_map.put("end-time-display", $end_time_display))
    #end
  #end
#end

#set ($day-1 = "Sunday, November 15")
#set ($day-2 = "Monday, November 16")
#set ($day-3 = "Tuesday, November 17")

<div class="" id="agendaWrapper">
  <div id="agendaTabs" class="togglers sticky-watch" data-offset='{"top": "-88"}'>
    #foreach ($day_to_print in $stringUtil.split($days_to_print))
      <span class="aui-w33 select-day select-day-$velocityCount class-toggle-carousel" data-target-class="day-$velocityCount" data-target-node="#wrapper" data-value="date-$velocityCount">
        #if ($velocityCount == 1)
          $day-1
        #elseif ($velocityCount == 2)
          $day-2
        #elseif ($velocityCount == 3)
          $day-3
        #end
      </span>
    #end
  </div>

  #foreach ($day_to_print in $stringUtil.split($days_to_print))

    #set ($day = {})
    #set ($day = $agenda.get("$day_to_print"))
    #set ($start_time_display = {})

    <table id="agenda-$day_to_print" class="agenda-table agenda-$velocityCount">
      #foreach ($row in $day)
        #set ($row_count = $velocityCount)

        <tr class="table-row $row_count">
          #set ($room_count = 0)
          #set ($row_end_time_display = $row.get("end-time-display"))
          #set ($start_time = $row.get("start-time"))
          #if ($start_time_display == $row.get("start-time-display"))
            #set($same-as-previous = true)
          #end
          #set ($start_time_display = $row.get("start-time-display"))

          #if ($same-as-previous)
            <td class="first-col"></td>
          #else
            <td class="first-col on-ryan-screen-helper" data-offset='{"top": "-155"}'>
              <div>$start_time_display</div>
            </td>
          #end

          #foreach ($session in $row.get("sessions"))
            #set ($custom_css_class = $session.get("custom-css-class"))
            #set ($end_time = $integer.parseInt($session.get("end-time")))
            #set ($extensions_time = false)
            #set ($is_liferay_seven = $session.get("is-liferay-seven"))
            #set ($room_count = $room_count + 1)
            #set ($room_name = $session.get("room-name"))
            #set ($room_number = $session.get("room-number"))
            #set ($row_end_time = $integer.parseInt($row.get("end-time")))
            #set ($row_sessions_size = $row.get("sessions").size())

            ## Find all extended sessions and mark them in the next array
            #set ($extension_count = 1)
            #mark_as_extended5($end_time $row_end_time $start_time)

            ## Get current rows extensions and generate all empty sessions
            #set ($extensions = $row.get("extended-sessions"))
            #set ($number_of_skipped_rooms = $room_number - $room_count)

            ## Set all variables needed for printing the td
            #set ($end_time_display = $session.get("end-time-display"))

            #set ($record = $session.get("record"))

            #set ($session_summary = $record.getFieldValue("session_summary"))

            #set ($session_type = $record.getFieldValue("session_type"))
            #set ($session_type = $stringUtil.replace($session_type, "[", ""))
            #set ($session_type = $stringUtil.replace($session_type, "]", ""))
            #set ($session_type = $stringUtil.replace($session_type, '"', ''))

            #set ($speaker_record = false)
            #if ($record.getFieldValue("speakers_uuid") != "")
              #set ($speaker_record_info = $ddl_records_local_service.getDDLRecordByUuidAndGroupId($record.getFieldValue("speakers_uuid"), $groupId))
              #set ($speaker_record = $ddl_records_local_service.fetchDDLRecord($getterUtil.getLong($speaker_record_info.recordId)))
            #end
            #if ($speaker_record)
              #set ($speaker_bio = $speaker_record.getFieldValue("speaker_bio"))
              #set ($speaker_company = $speaker_record.getFieldValue("speaker_company"))
              #set ($speaker_name = $speaker_record.getFieldValue("speaker_name"))
              #set ($speaker_title = $speaker_record.getFieldValue("speaker_title"))
            #else
              #set ($speaker_bio = "")
              #set ($speaker_company = "")
              #set ($speaker_name = "")
              #set ($speaker_title = "")
            #end

            #set ($title = $record.getFieldValue("title"))
            #set ($filter_categories = $record.getFieldValue("filter_categories"))
            #set ($filter_categories = $stringUtil.replace($filter_categories, "[", ""))
            #set ($filter_categories = $stringUtil.replace($filter_categories, "]", ""))
            #set ($filter_categories = $stringUtil.replace($filter_categories, '"', ''))
            #set ($filter_categories = $stringUtil.replace($filter_categories, ',', ' '))

            #set ($pop_up_css_class = "pop-up")

            #if ($custom_css_class)
              #set ($pop_up_css_class = "$pop_up_css_class $custom_css_class")
            #end

            #if ($row_sessions_size == 1 && $extensions.size() == 0)
              #set ($colspan = "colspan='$default_col_span'")
              #set ($pop_up_css_class = "$pop_up_css_class single-row-td")
            #else
              #set ($colspan = "")

              #set ($pop_up_css_class = "$pop_up_css_class multi-room-td room-$room_number")
            #end

            #if ($filter_categories != "" && $filter_categories)
              #set ($pop_up_css_class = "$pop_up_css_class $filter_categories")
            #end

            #if($extension_count > 1)
              #set ($rowspan = "rowspan='$extension_count'")
            #else
              #set ($rowspan = "")
            #end

            ## Print td
            <td class="$pop_up_css_class" $colspan $rowspan onclick="ga('send', 'event', 'Conferences - North America 2015', 'Agenda Session Clicks', '$title - $speaker_name');">
              #if ($session_type != "blank" && $session_type != "")
                <span>$session_type:</span>
              #end

              #if ($title != "")
                <span class="trigger">$title</span><br>
              #end

              #if ($is_liferay_seven == "true" && $validator.isNotNull($is_liferay_seven))
                  <div class="liferay-seven-icon"></div>
              #end

              <div class="pop-up-content">
                <span class="data">
                  <div class="room-session">
                    #if ($room_name != "") Room: $room_name,#end Time: $start_time_display - $end_time_display<br>
                  </div>

                  #set ($speaker_array_uuid = $stringUtil.split($record.getFieldValue("speakers_uuid")))

                  #foreach ($speakers_uuid in $speaker_array_uuid)
                    #set ($speakers_uuid = $stringUtil.trim($speakers_uuid))
                    #set ($speaker_record = false)
                    #if ("$speakers_uuid" != "")
                      #set ($speaker_record_info = $ddl_records_local_service.getDDLRecordByUuidAndGroupId($speakers_uuid, $groupId))
                      #set ($speaker_record = $ddl_records_local_service.fetchDDLRecord($getterUtil.getLong($speaker_record_info.recordId)))
                    #end
                    #if ($speaker_record)
                      #set ($speaker_bio = $speaker_record.getFieldValue("speaker_bio"))
                      #set ($speaker_company = $speaker_record.getFieldValue("speaker_company"))
                      #set ($speaker_name = $speaker_record.getFieldValue("speaker_name"))
                      #set ($speaker_title = $speaker_record.getFieldValue("speaker_title"))
                    #else
                      #set ($speaker_bio = "")
                      #set ($speaker_company = "")
                      #set ($speaker_name = "")
                      #set ($speaker_title = "")
                    #end

                    <div class="speaker-information">
                      #if ($speaker_name != "")
                        <strong>$speaker_name</strong>
                      #end
                      <div>
                        #if ($speaker_title != "" && $speaker_company != "")
                          $speaker_title, $speaker_company
                        #end
                      </div>
                    </div>
                  #end

                  #if ($session_summary != "")
                    Session Summary:<br /><p>$session_summary</p>
                  #end
                </span>
              </div>

              #if ("speakers_uuid" != "")
                <div class="speakers-agenda-info">
                  #foreach ($speakers_uuid in $speaker_array_uuid)
                    #set ($speakers_uuid = $stringUtil.trim($speakers_uuid))
                    #set ($speaker_record = false)
                    #if ("$speakers_uuid" != "")
                      #set ($speaker_record_info = $ddl_records_local_service.getDDLRecordByUuidAndGroupId($speakers_uuid, $groupId))
                      #set ($speaker_record = $ddl_records_local_service.fetchDDLRecord($getterUtil.getLong($speaker_record_info.recordId)))
                    #end
                    #if ($speaker_record)
                      #set ($speaker_name = $speaker_record.getFieldValue("speaker_name"))
                      #set ($speaker_company = $speaker_record.getFieldValue("speaker_company"))
                      #set ($speaker_title = $speaker_record.getFieldValue("speaker_title"))
                    #else
                      #set ($speaker_name = "")
                      #set ($speaker_company = "")
                      #set ($speaker_title = "")
                    #end

                    <div class="speaker-entry">
                      #if ($speaker_name != "" && $speaker_company != "")
                        $speaker_name, $speaker_company
                                                    #else 
                                 $speaker_name
                      #end
                    </div>
                  #end
                </div>
              #end

              #if ($room_name != "")
                ($room_name)
              #end

              #if ($user_has_permissions)
                <a class="taglib-icon edit-only" href="/web/events2015/northamerica/admin?p_p_id=169_INSTANCE_eAy8Mn7LeZLJ&p_p_lifecycle=0&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_pos=4&p_p_col_count=8&_169_INSTANCE_eAy8Mn7LeZLJ_struts_action=%2Fdynamic_data_list_display%2Fedit_record&_169_INSTANCE_eAy8Mn7LeZLJ_cmd=update&_169_INSTANCE_eAy8Mn7LeZLJ_redirect=https%3A%2F%2Fwww.liferay.com%2Fweb%2Fevents2015%2Fnorthamerica%2Fadmin%3Fp_p_id%3D169_INSTANCE_eAy8Mn7LeZLJ%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-1%26p_p_col_pos%3D4%26p_p_col_count%3D8&_169_INSTANCE_eAy8Mn7LeZLJ_recordId=$record.getRecordId()">
                  <img class="icon" src="/osb-community-theme/images/common/edit.png" alt="Edit DDL Record" title="Edit DDL Record">
                </a>
              #end
            </td>
          #end
        </tr>
      #end
    </table>
  #end

  <div class="categorySelectors desktop-only sticky-watch" data-offset='{"top": "-176"}'>
    <span class="filter-header">Filter by:</span>
    <a class="category" data-target-class="marketing" data-selected="false">Digital Marketing & Web Experiences</a>
    <a class="category" data-target-class="using" data-selected="false">Case Study</a>
    <a class="category" data-target-class="customize" data-selected="false">Customizing Liferay</a>
    <a class="category" data-target-class="develop" data-selected="false">Developing with Liferay</a>
    <a class="category" data-target-class="production" data-selected="false">Liferay in Production</a>
    <a class="category" data-target-class="features" data-selected="false">Liferay New Products & Features</a>
    <a class="category" data-target-class="technologies" data-selected="false">Mobile Technologies & Development</a>
    <a class="category" data-target-class="ui" data-selected="false">UI & UX</a>
  </div>
</div>

<style>
#agendaTabs .select-day {
  height: 100%;
}

#agendaTabs.sticky {
  position: fixed;
  top: 88px;
}

#agendaWrapper {
  margin: auto;
  min-height: 670px;
  overflow: hidden;
  position: relative;
}

#agendaWrapper table {
  box-sizing: border-box;
}

#agendaWrapper tr {
  border-bottom: 1px solid #E3E4E5;
}

#agendaWrapper td {
    display: inline-block;
    padding: 10px;
    min-height: 75px;
    max-width: calc(100% - 220px);
}

#agendaWrapper td.empty-session {
  display: none;
}

#agendaWrapper td.multi-room-td {
  border-bottom: 1px solid #E3E4E5;
  display: block;
}

#agendaWrapper td.pop-up.last {
  border-bottom-width: 0;
}

#agendaWrapper td.multi-room-td:last-child {
  border-bottom: 0;
}

#agendaWrapper.hide-all tr, #agendaWrapper.hide-all td {
  display: none;
}

#agendaWrapper.hide-all .display-marketing .marketing .first-col,
#agendaWrapper.hide-all .display-customize .customize .first-col,
#agendaWrapper.hide-all .display-develop .develop .first-col,
#agendaWrapper.hide-all .display-production .production .first-col,
#agendaWrapper.hide-all .display-features .features .first-col,
#agendaWrapper.hide-all .display-technologies .technologies .first-col,
#agendaWrapper.hide-all .display-ui .ui .first-col,
#agendaWrapper.hide-all .display-using .using .first-col {
  display: table-cell;
  margin-bottom: -1px;
}

#agendaWrapper.hide-all .display-marketing td.marketing,
#agendaWrapper.hide-all .display-customize td.customize,
#agendaWrapper.hide-all .display-develop td.develop,
#agendaWrapper.hide-all .display-production td.production,
#agendaWrapper.hide-all .display-features td.features,
#agendaWrapper.hide-all .display-technologies td.technologies,
#agendaWrapper.hide-all .display-ui td.ui,
#agendaWrapper.hide-all .display-using td.using {
  display: block;
  margin-bottom: -1px;
}

#agendaWrapper.hide-all .display-marketing tr.marketing,
#agendaWrapper.hide-all .display-customize tr.customize,
#agendaWrapper.hide-all .display-develop tr.develop,
#agendaWrapper.hide-all .display-production tr.production,
#agendaWrapper.hide-all .display-features tr.features,
#agendaWrapper.hide-all .display-technologies tr.technologies,
#agendaWrapper.hide-all .display-ui tr.ui,
#agendaWrapper.hide-all .display-using tr.using {
  display: table-row;
}

#agendaWrapper .first-col {
  background: #FFF;
  color: #909295;
  display: table-cell;
  font-size: 36px;
  font-weight: lighter;
  text-align: left;
  vertical-align: top;
  width: 20%;
}

#agendaWrapper .pop-up {
  width: 100%;
  width: calc(100% - 20px)
}

#agendaWrapper .pop-up:hover {
  cursor: pointer;
}

#agendaWrapper .pop-up-content {
  display: none;
}

#agendaWrapper .single-row-td {
  background: #F2F2F2;
}

#agendaWrapper .speaker-entry {
  color: #818183;
}

#agendaWrapper .togglers {
  background: #FFF;
  border: 1px solid #CCC;
  border-left: 0px solid;
  border-right: 0px solid;
  text-align: center;
  width: 100%;
  z-index: 10;
}

#agendaWrapper .togglers span:last-of-type {
  border-right: none;
}

#agendaWrapper .togglers .class-toggle-carousel {
  border-right: 1px solid #CCC;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  font-size: 18px;
  margin-left: -3px;
  padding: 20px;
  text-align: center;
  text-decoration: none;
  vertical-align: top;
  width: 33.33%;
}

#agendaWrapper .trigger {
  font-size: 18px;
  letter-spacing: 2px;
  text-transform: uppercase;
}

#wrapper .agenda-1,
#wrapper .agenda-3,
#wrapper.class-toggle-carousel-day-1 .agenda-2,
#wrapper.class-toggle-carousel-day-2 .agenda-1,
#wrapper.class-toggle-carousel-day-2 .agenda-3,
#wrapper.class-toggle-carousel-day-3 .agenda-1,
#wrapper.class-toggle-carousel-day-3 .agenda-2,
#wrapper.hide-all td {
    display: none;
}

#wrapper #agendaWrapper,
#wrapper #agendaWrapper .select-day-2,
#wrapper.class-toggle-carousel-day-1 #agendaWrapper .select-day-1,
#wrapper.class-toggle-carousel-day-3 #agendaWrapper .select-day-3 {
  font-weight: normal;
}

#wrapper #agendaWrapper .select-day-2, #wrapper.class-toggle-carousel-day-2 #agendaWrapper .select-day-2.class-toggle-carousel,
#wrapper.class-toggle-carousel-day-1 #agendaWrapper .select-day-1.class-toggle-carousel,
#wrapper.class-toggle-carousel-day-3 #agendaWrapper .select-day-3.class-toggle-carousel {
  background: #178ACB;
  color: #FFF;
}

#wrapper #agendaWrapper .select-day-1,
#wrapper #agendaWrapper .select-day-3,
#wrapper.class-toggle-carousel-day-1 #agendaWrapper .select-day-2,
#wrapper.class-toggle-carousel-day-2 #agendaWrapper .select-day-1,
#wrapper.class-toggle-carousel-day-2 #agendaWrapper .select-day-3,
#wrapper.class-toggle-carousel-day-3 #agendaWrapper .select-day-1,
#wrapper.class-toggle-carousel-day-3 #agendaWrapper .select-day-2 {
  background: #FFF;
  color: #4C4C4E;
    font-weight: lighter;
}

#wrapper #agendaWrapper .togglers .class-toggle-carousel:hover {
  background: #F7BC20;
  color: #FFF;
}

#wrapper.class-toggle-carousel-day-1 .agenda-1,
#wrapper.class-toggle-carousel-day-2 #agendaWrapper .agenda-2,
#wrapper.class-toggle-carousel-day-3 #agendaWrapper .agenda-3 {
    display: table;
}

#wrapper .agenda-3, #wrapper.class-toggle-carousel-day-2 .agenda-1, #wrapper.class-toggle-carousel-day-2 .agenda-3, #wrapper.class-toggle-carousel-day-3 .agenda-1, #wrapper.class-toggle-carousel-day-3 .agenda-2, #wrapper.hide-all td {
  display: none;
}

.agenda-table.sticky-nav {
  margin-top: 60px;
}

.categorySelectors {
  text-align: center;
}

.categorySelectors div {
  display: inline-block;
  padding: 5px 20px;
}

.categorySelectors.desktop-only {
  background: #FFF;
  border-bottom: 0px solid;
  border-right: 0px solid;
  border: 1px solid #CCC;
  box-sizing: border-box;
  height: 100%;
  padding: 30px 15px;
  position: absolute;
  right: 0px;
  text-align: left;
  top: 68px;
  width: 200px;
  z-index: 10;
}

.categorySelectors.desktop-only.sticky {
  position: fixed;
  top: 156px;
}

.categorySelectors .category {
  background: url(/documents/35935946/36204249/Close-Icon.png) no-repeat;
  color: #1A1A1A;
  cursor: pointer;
  display: block;
  margin: 5px;
  padding: 8px 25px 8px 8px;
  text-decoration: none;
}

.categorySelectors .filter-header {
  font-weight: normal;
  padding: 15px;
}

.categorySelectors .marketing-selected,
.categorySelectors .customize-selected,
.categorySelectors .develop-selected,
.categorySelectors .production-selected,
.categorySelectors .features-selected,
.categorySelectors .technologies-selected,
.categorySelectors .ui-selected,
.categorySelectors .using-selected {
  background-position: 92% 50%;
  color: #178ACB;
  font-weight: normal;
}

.category-toggle-container .aui-toggler-content-collapsed, .controls-hidden .edit-only, .controls-hidden form .separator, .controls-hidden form .aui-button, .desktop-hidden, .taglib-header {
  display: none;
}

.category-toggle-container .aui-toggler-header-collapsed .arrow {
  border: 7px solid transparent;
  border-bottom-width: 0;
  border-top-color: #4C4C4C;
  content: "";
  display: inline-block;
  height: 0;
  margin: 0 5px;
  width: 0;
}

.category-toggle-container .aui-toggler-header-expanded .arrow {
  border: 7px solid transparent;
  border-bottom-color: #4C4C4C;
  border-top-width: 0;
  content: "";
  display: inline-block;
  height: 0;
  margin: 0 5px;
  width: 0;
}

.category-toggle-container .toggle-header {
  cursor: pointer;
  margin: 10px;
}

.keynote {
  color: #005E8E;
  font-weight: normal;
}

.lfr-meta-actions, .portlet-body {
  clear: both;
}

.liferay-seven-icon {
    background: url('/documents/47511614/51371158/Liferay-7-Icon.png') no-repeat center center;
    background-size: cover;
    float: right;
    height: 34px;
    width: 34px;
}

.on-screen-bop {
  position: relative;
  z-index: -1;
}

.on-screen-bop div {
  background: #FFF;
  position: fixed;
  text-align: left;
  top: 168px;
  width: 130px;
}

.on-screen-bop.on-screen-boo-bop div {
  position: absolute;
  top: 0;
}

.pop-up-content {
  color: #6B6C6B;
}

.pop-up-content .view-all-bio-link, .pop-up-content .room-session, .pop-up-content .speaker-information {
  padding-bottom: 1em;
}

.ie8 .pop-up-content {
  background: #6B6C6B;
  color: #FFF;
}

@media all and (max-width: 900px) {
#agendaWrapper td {
    max-width: 100%;
}

  #agendaWrapper .first-col, .on-screen-bop div, .on-screen-bop.on-screen-boo-bop div {
    width: 120px;
  }

  #agendaWrapper .togglers {
    margin-right: 0;
    width: 100%;
    position: initial;
  }

  #agendaWrapper table {
    max-width: 100%;
  }

  #agendaWrapper td.multi-room-td {
    box-sizing: border-box;
    width: 100%;
  }

  .agenda-table.sticky-nav {
    margin-top: 0;
  }

  .desktop-hidden {
    display: block;
  }

  .desktop-only {
    display: none;
  }

  .first-col div {
    text-align: left;
  }

  .on-screen-bop div, .on-screen-bop.on-screen-boo-bop div  {
    position: initial;
  }
}
</style>

<script>
AUI().use(
  'node',
  function(A) {
    var category = A.all('.category');

    var displayClass = function(event) {
      event.stopPropagation();

      var agendaTable = A.all('.agenda-table');

      var agendaWrapper = A.one('#agendaWrapper');

      var currentTargetNode = event.currentTarget;

      var dataSelected = currentTargetNode.attr('data-selected');

      var targetClass = currentTargetNode.attr('data-target-class');

      var displayTargetClass = 'display-' + targetClass;

      var selectedCategoryClass = targetClass + '-selected';

      if (targetClass) {
        agendaTable.toggleClass(displayTargetClass);

        A.all('.' + targetClass).each(
          function(node) {
            node.ancestorsByClassName('table-row').addClass(targetClass);
          }
        );
      }

      if (dataSelected == 'false') {
        currentTargetNode.setAttribute('data-selected', 'true');
      }
      else {
        currentTargetNode.setAttribute('data-selected', 'false');
      }

      var hideAll = false;

      category.each(
        function(node) {
          if (node.getAttribute('data-selected') == 'true') {
            hideAll = true;
          }
        }
      );

      if (hideAll) {
        agendaWrapper.addClass('hide-all');

        currentTargetNode.toggleClass(selectedCategoryClass);
      }
      else {
        agendaWrapper.removeClass('hide-all');

        currentTargetNode.toggleClass(selectedCategoryClass);
      }
    };

    category.on('click', displayClass);

    /**
     * Multiple Room Action
     **/

    var MRAction= function() {
      this.prototype = {
        get_categories : function(node) {
          var data = [];

          A.all(node).each(
            function(el) {
              if (el.getAttribute("data-selected") === "true") {
                data.push(el.getAttribute("data-target-class"));
              }
            }
          );

          return data;
        },

        get_table_cells : function(filterArray, nodes) {
          var data = [];
          var queryNode = A.all(nodes);

          queryNode.each(
            function(node) {
              var nodeCollectionSet = [];

              var containerNode = A.one(node.getDOM().parentNode);
              var classListenerNode = containerNode.all('.pop-up');

              classListenerNode.each(
                function(el) {
                  var nodeHasProperty = false;

                  A.all(filterArray).each(
                    function(filter) {
                      if (el.hasClass(filter)) {
                        nodeHasProperty = true;
                      }
                    }
                  );

                  if (nodeHasProperty) {
                    nodeCollectionSet.push(el);
                  }
                }
              );

              data.push(nodeCollectionSet);
            }
          );

          return data;
        },

        remove_last_class : function(valueArray) {
          A.each(valueArray, function(nodeArray) {
            A.each(nodeArray, function(node) {
              if (node.hasClass('last')) {
                node.removeClass('last');
              }
            });
          });
        },

        apply_last_class : function(valueArray) {
          A.each(valueArray, function(sousArray) {
            if (sousArray.length !== 0) {
              var node = sousArray[sousArray.length - 1];

              node.addClass('last');
            }
          });
        }
      };

      return this.prototype;
    };

    category.on(
      'click', function() {
        var multiple_room = new MRAction();

        var cat = multiple_room.get_categories(".categorySelectors .category");
        var tableCells = multiple_room.get_table_cells(cat, '#agendaWrapper .first-col');

        multiple_room.remove_last_class(tableCells);
        multiple_room.apply_last_class(tableCells);
      }
    );
  }
);

AUI().use(
  'aui-toggler',
  function(A) {
    new A.TogglerDelegate(
      {
        animated: false,
        closeAllOnExpand: false,
        container: '.category-toggle-container',
        content: '.toggle-content',
        expanded: false,
        header: '.toggle-header'
      }
    );
  }
);
</script>